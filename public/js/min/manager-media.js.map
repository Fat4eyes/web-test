{"version":3,"sources":["media.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"manager-media.js","sourcesContent":["$(document).ready(function () {\n    var anchor;\n    var mediaViewModel = function () {\n        return new function () {\n            var self = this;\n\n            initializeViewModel.call(self, {\n                page: menu.admin.materials,\n                mode: true\n            });\n\n            self.media = ko.observable({\n                id: ko.observable(0),\n                type: ko.observable(''),\n                content: ko.observable(''),\n                path: ko.observable(''),\n                name: ko.observable(''),\n                hash: ko.observable('')\n            });\n\n            self.name = ko.observable('');\n            self.anchor = ko.observable('');\n\n            self.initialize = function () {\n                $('body').addClass('media');\n            };\n\n            self.fill = function (data) {\n                self.media()\n                    .id(data.id())\n                    .type(data.type())\n                    .content(data.content())\n                    .path(data.path())\n                    .name(data.name())\n                    .hash(data.hash());\n            };\n\n            self.getMedia = function () {\n                var mediaId;\n                var currentUrl = window.location.href;\n                var urlParts = currentUrl.split('/');\n                if (urlParts[urlParts.length-1].indexOf('#') != -1) {\n                    mediaId = urlParts[urlParts.length-1].split('#')[0];\n                    self.anchor(urlParts[urlParts.length-1].split('#')[1]);\n                }\n                else mediaId = +urlParts[urlParts.length-1];\n\n                $ajaxget({\n                    url: '/api/media/' + mediaId,\n                    errors: self.errors,\n                    successCallback: function(data){\n                        self.fill(data);\n                        self.name(data.name().substring(0, data.name().lastIndexOf('.')));\n                        document.title = self.name();\n                    }\n                });\n            };\n\n            self.goToAnchor = function () {\n                if (self.anchor().length > 0 && $('#' + self.anchor()).length) {\n                   $('html, body').animate({\n                       scrollTop: $('#' + self.anchor()).offset().top\n                   }, 0);\n                }\n\n            };\n\n            self.initialize();\n            self.getMedia();\n\n            ko.bindingHandlers.afterHtmlRender = {\n                update: function(element, valueAccessor, allBindings){\n                    allBindings().html && valueAccessor()(allBindings().html());\n                }\n            };\n\n        };\n    };\n\n    ko.applyBindings(mediaViewModel());\n\n});\n\n"]}